/* psra_1.Create_table_chazard_ALL.sql */
-- script to generate hazard map mean
CREATE SCHEMA IF NOT EXISTS psra_{prov};

DROP TABLE IF EXISTS psra_{prov}.psra_{prov}_hcurves_pga CASCADE;

-- create table
CREATE TABLE psra_{prov}.psra_{prov}_hcurves_pga(
lon float,
lat float,
depth float,
"poe_0.0500000" float,
"poe_0.0637137" float,
"poe_0.0811888" float,
"poe_0.1034569" float,
"poe_0.1318325" float,
"poe_0.1679909" float,
"poe_0.2140666" float,
"poe_0.2727797" float,
"poe_0.3475964" float,
"poe_0.4429334" float,
"poe_0.5644189" float,
"poe_0.7192249" float,
"poe_0.9164904" float,
"poe_1.1678607" float,
"poe_1.4881757" float,
"poe_1.8963451" float,
"poe_2.4164651" float,
"poe_3.0792411" float,
"poe_3.9237999" float,
"poe_5.0000000" float

);




-- script to generate hazard map mean
CREATE SCHEMA IF NOT EXISTS psra_{prov};

DROP TABLE IF EXISTS psra_{prov}.psra_{prov}_hcurves_sa0p1 CASCADE;

-- create table
CREATE TABLE psra_{prov}.psra_{prov}_hcurves_sa0p1(
lon float,
lat float,
depth float,
"poe_0.0500000" float,
"poe_0.0637137" float,
"poe_0.0811888" float,
"poe_0.1034569" float,
"poe_0.1318325" float,
"poe_0.1679909" float,
"poe_0.2140666" float,
"poe_0.2727797" float,
"poe_0.3475964" float,
"poe_0.4429334" float,
"poe_0.5644189" float,
"poe_0.7192249" float,
"poe_0.9164904" float,
"poe_1.1678607" float,
"poe_1.4881757" float,
"poe_1.8963451" float,
"poe_2.4164651" float,
"poe_3.0792411" float,
"poe_3.9237999" float,
"poe_5.0000000" float

);




-- script to generate hazard map mean
CREATE SCHEMA IF NOT EXISTS psra_{prov};

DROP TABLE IF EXISTS psra_{prov}.psra_{prov}_hcurves_sa0p2 CASCADE;

-- create table
CREATE TABLE psra_{prov}.psra_{prov}_hcurves_sa0p2(
lon float,
lat float,
depth float,
"poe_0.0500000" float,
"poe_0.0637137" float,
"poe_0.0811888" float,
"poe_0.1034569" float,
"poe_0.1318325" float,
"poe_0.1679909" float,
"poe_0.2140666" float,
"poe_0.2727797" float,
"poe_0.3475964" float,
"poe_0.4429334" float,
"poe_0.5644189" float,
"poe_0.7192249" float,
"poe_0.9164904" float,
"poe_1.1678607" float,
"poe_1.4881757" float,
"poe_1.8963451" float,
"poe_2.4164651" float,
"poe_3.0792411" float,
"poe_3.9237999" float,
"poe_5.0000000" float

);




-- script to generate hazard map mean
CREATE SCHEMA IF NOT EXISTS psra_{prov};

DROP TABLE IF EXISTS psra_{prov}.psra_{prov}_hcurves_sa0p3 CASCADE;

-- create table
CREATE TABLE psra_{prov}.psra_{prov}_hcurves_sa0p3(
lon float,
lat float,
depth float,
"poe_0.0500000" float,
"poe_0.0637137" float,
"poe_0.0811888" float,
"poe_0.1034569" float,
"poe_0.1318325" float,
"poe_0.1679909" float,
"poe_0.2140666" float,
"poe_0.2727797" float,
"poe_0.3475964" float,
"poe_0.4429334" float,
"poe_0.5644189" float,
"poe_0.7192249" float,
"poe_0.9164904" float,
"poe_1.1678607" float,
"poe_1.4881757" float,
"poe_1.8963451" float,
"poe_2.4164651" float,
"poe_3.0792411" float,
"poe_3.9237999" float,
"poe_5.0000000" float

);




-- script to generate hazard map mean
CREATE SCHEMA IF NOT EXISTS psra_{prov};

DROP TABLE IF EXISTS psra_{prov}.psra_{prov}_hcurves_sa0p5 CASCADE;

-- create table
CREATE TABLE psra_{prov}.psra_{prov}_hcurves_sa0p5(
lon float,
lat float,
depth float,
"poe_0.0500000" float,
"poe_0.0658662" float,
"poe_0.0867671" float,
"poe_0.1143003" float,
"poe_0.1505706" float,
"poe_0.1983502" float,
"poe_0.2612914" float,
"poe_0.3442054" float,
"poe_0.4534299" float,
"poe_0.5973140" float,
"poe_0.7868559" float,
"poe_1.0365439" float,
"poe_1.3654639" float,
"poe_1.7987580" float,
"poe_2.3695466" float,
"poe_3.1214600" float,
"poe_4.1119734" float,
"poe_5.4168002" float,
"poe_7.1356795" float,
"poe_9.4000000" float

);




-- script to generate hazard map mean
CREATE SCHEMA IF NOT EXISTS psra_{prov};

DROP TABLE IF EXISTS psra_{prov}.psra_{prov}_hcurves_sa0p6 CASCADE;

-- create table
CREATE TABLE psra_{prov}.psra_{prov}_hcurves_sa0p6(
lon float,
lat float,
depth float,
"poe_0.0500000" float,
"poe_0.0658662" float,
"poe_0.0867671" float,
"poe_0.1143003" float,
"poe_0.1505706" float,
"poe_0.1983502" float,
"poe_0.2612914" float,
"poe_0.3442054" float,
"poe_0.4534299" float,
"poe_0.5973140" float,
"poe_0.7868559" float,
"poe_1.0365439" float,
"poe_1.3654639" float,
"poe_1.7987580" float,
"poe_2.3695466" float,
"poe_3.1214600" float,
"poe_4.1119734" float,
"poe_5.4168002" float,
"poe_7.1356795" float,
"poe_9.4000000" float

);




-- script to generate hazard map mean
CREATE SCHEMA IF NOT EXISTS psra_{prov};

DROP TABLE IF EXISTS psra_{prov}.psra_{prov}_hcurves_sa1p0 CASCADE;

-- create table
CREATE TABLE psra_{prov}.psra_{prov}_hcurves_sa1p0(
lon float,
lat float,
depth float,
"poe_0.0500000" float,
"poe_0.0637137" float,
"poe_0.0811888" float,
"poe_0.1034569" float,
"poe_0.1318325" float,
"poe_0.1679909" float,
"poe_0.2140666" float,
"poe_0.2727797" float,
"poe_0.3475964" float,
"poe_0.4429334" float,
"poe_0.5644189" float,
"poe_0.7192249" float,
"poe_0.9164904" float,
"poe_1.1678607" float,
"poe_1.4881757" float,
"poe_1.8963451" float,
"poe_2.4164651" float,
"poe_3.0792411" float,
"poe_3.9237999" float,
"poe_5.0000000" float

);




-- script to generate hazard map mean
CREATE SCHEMA IF NOT EXISTS psra_{prov};

DROP TABLE IF EXISTS psra_{prov}.psra_{prov}_hcurves_sa2p0 CASCADE;

-- create table
CREATE TABLE psra_{prov}.psra_{prov}_hcurves_sa2p0(
lon float,
lat float,
depth float,
"poe_0.0500000" float,
"poe_0.0637137" float,
"poe_0.0811888" float,
"poe_0.1034569" float,
"poe_0.1318325" float,
"poe_0.1679909" float,
"poe_0.2140666" float,
"poe_0.2727797" float,
"poe_0.3475964" float,
"poe_0.4429334" float,
"poe_0.5644189" float,
"poe_0.7192249" float,
"poe_0.9164904" float,
"poe_1.1678607" float,
"poe_1.4881757" float,
"poe_1.8963451" float,
"poe_2.4164651" float,
"poe_3.0792411" float,
"poe_3.9237999" float,
"poe_5.0000000" float

);




-- script to generate hazard map mean
CREATE SCHEMA IF NOT EXISTS psra_{prov};

DROP TABLE IF EXISTS psra_{prov}.psra_{prov}_hmaps CASCADE;

-- create table
CREATE TABLE psra_{prov}.psra_{prov}_hmaps(
lon float,
lat float,
"PGA_0.02" float,
"PGA_0.1" float,
"SA(0.1)_0.02" float,
"SA(0.1)_0.1" float,
"SA(0.2)_0.02" float,
"SA(0.2)_0.1" float,
"SA(0.3)_0.02" float,
"SA(0.3)_0.1" float,
"SA(0.5)_0.02" float,
"SA(0.5)_0.1" float,
"SA(0.6)_0.02" float,
"SA(0.6)_0.1" float,
"SA(1.0)_0.02" float,
"SA(1.0)_0.1" float,
"SA(10.0)_0.02" float,
"SA(10.0)_0.1" float,
"SA(2.0)_0.02" float,
"SA(2.0)_0.1" float,
"SA(5.0)_0.02" float,
"SA(5.0)_0.1" float
);




--incorporate after xref tables are pushed on github
-- script to create xref table
CREATE SCHEMA IF NOT EXISTS psra_{prov};

DROP TABLE IF EXISTS psra_{prov}.psra_{prov}_hmaps_xref;

-- create table
CREATE TABLE psra_{prov}.psra_{prov}_hmaps_xref(
PRIMARY KEY(id),
id varchar,
sauid varchar,
asset_lon float,
asset_lat float,
lon float,
lat float,
distance float,
"PGA_0.02" float,
"PGA_0.1" float,
"SA(0.1)_0.02" float,
"SA(0.1)_0.1" float,
"SA(0.2)_0.02" float,
"SA(0.2)_0.1" float,
"SA(0.3)_0.02" float,
"SA(0.3)_0.1" float,
"SA(0.5)_0.02" float,
"SA(0.5)_0.1" float,
"SA(0.6)_0.02" float,
"SA(0.6)_0.1" float,
"SA(1.0)_0.02" float,
"SA(1.0)_0.1" float,
"SA(10.0)_0.02" float,
"SA(10.0)_0.1" float,
"SA(2.0)_0.02" float,
"SA(2.0)_0.1" float,
"SA(5.0)_0.02" float,
"SA(5.0)_0.1" float
);




-- script to generate hazard map mean
CREATE SCHEMA IF NOT EXISTS psra_{prov};

DROP TABLE IF EXISTS psra_{prov}.psra_{prov}_uhs CASCADE;

-- create table
CREATE TABLE psra_{prov}.psra_{prov}_uhs(
lon float,
lat float,
"0.02_PGA" float,
"0.02_SA(0.1)" float,
"0.02_SA(0.2)" float,
"0.02_SA(0.3)" float,
"0.02_SA(0.5)" float,
"0.02_SA(0.6)" float,
"0.02_SA(1.0)" float,
"0.02_SA(2.0)" float,
"0.1_PGA" float,
"0.1_SA(0.1)" float,
"0.1_SA(0.2)" float,
"0.1_SA(0.3)" float,
"0.1_SA(0.5)" float,
"0.1_SA(0.6)" float,
"0.1_SA(1.0)" float,
"0.1_SA(2.0)" float

);




/* psra_2.Create_table_dmg_mean.sql */
-- script to generate cd/ed structural mean - b0, r2
DROP TABLE IF EXISTS psra_{prov}.psra_{prov}_cd_dmg_mean_b0, psra_{prov}.psra_{prov}_cd_dmg_mean_r1, psra_{prov}.psra_{prov}_cd_dmg_mean, psra_{prov}.psra_{prov}_ed_dmg_mean_b0, psra_{prov}.psra_{prov}_ed_dmg_mean_r1,
psra_{prov}.psra_{prov}_ed_dmg_mean CASCADE;

-- create cd table b0
CREATE TABLE psra_{prov}.psra_{prov}_cd_dmg_mean_b0(
PRIMARY KEY (asset_id),
asset_id varchar, 
"BldEpoch" varchar,
"BldgType" varchar,
"EqDesLev" varchar, 
"GenOcc" varchar, 
"GenType" varchar,
"LandUse" varchar, 
"OccClass" varchar,
"SAC" varchar, 
"SSC_Zone" varchar,
"SauidID" varchar,
adauid varchar, 
cdname varchar, 
cduid varchar,
csdname varchar, 
csduid varchar,
dauid varchar, 
ername varchar,
eruid varchar,
fsauid varchar, 
prname varchar, 
pruid varchar,
sauid varchar, 
taxonomy varchar, 
lon float, 
lat float, 
structural_no_damage float, 
structural_slight float, 
structural_moderate float, 
structural_extensive float, 
structural_complete float
);




-- create cd table r2
CREATE TABLE psra_{prov}.psra_{prov}_cd_dmg_mean_r2(
PRIMARY KEY (asset_id),
asset_id varchar, 
"BldEpoch" varchar,
"BldgType" varchar,
"EqDesLev" varchar, 
"GenOcc" varchar, 
"GenType" varchar,
"LandUse" varchar, 
"OccClass" varchar,
"SAC" varchar, 
"SSC_Zone" varchar,
"SauidID" varchar,
adauid varchar, 
cdname varchar, 
cduid varchar,
csdname varchar, 
csduid varchar,
dauid varchar, 
ername varchar,
eruid varchar,
fsauid varchar, 
prname varchar, 
pruid varchar,
sauid varchar, 
taxonomy varchar, 
lon float, 
lat float, 
structural_no_damage float, 
structural_slight float, 
structural_moderate float, 
structural_extensive float, 
structural_complete float
);




-- create ed table b0
CREATE TABLE psra_{prov}.psra_{prov}_ed_dmg_mean_b0(
PRIMARY KEY (asset_id),
asset_id varchar, 
"BldEpoch" varchar,
"BldgType" varchar,
"EqDesLev" varchar, 
"GenOcc" varchar, 
"GenType" varchar,
"LandUse" varchar, 
"OccClass" varchar,
"SAC" varchar, 
"SSC_Zone" varchar,
"SauidID" varchar,
adauid varchar, 
cdname varchar, 
cduid varchar,
csdname varchar, 
csduid varchar,
dauid varchar, 
ername varchar,
eruid varchar,
fsauid varchar, 
prname varchar, 
pruid varchar,
sauid varchar, 
taxonomy varchar, 
lon float, 
lat float, 
structural_no_damage float, 
structural_slight float, 
structural_moderate float, 
structural_extensive float, 
structural_complete float
);



-- create cd table r1
CREATE TABLE psra_{prov}.psra_{prov}_ed_dmg_mean_r1(
PRIMARY KEY (asset_id),
asset_id varchar, 
"BldEpoch" varchar,
"BldgType" varchar,
"EqDesLev" varchar, 
"GenOcc" varchar, 
"GenType" varchar,
"LandUse" varchar, 
"OccClass" varchar,
"SAC" varchar, 
"SSC_Zone" varchar,
"SauidID" varchar,
adauid varchar, 
cdname varchar, 
cduid varchar,
csdname varchar, 
csduid varchar,
dauid varchar, 
ername varchar,
eruid varchar,
fsauid varchar, 
prname varchar, 
pruid varchar,
sauid varchar, 
taxonomy varchar, 
lon float, 
lat float, 
structural_no_damage float, 
structural_slight float, 
structural_moderate float, 
structural_extensive float, 
structural_complete float
);




/* psra_3.Create_table_agg_curves_stats.sql */
-- script to agg curves - q05
DROP TABLE IF EXISTS psra_{prov}.psra_{prov}_agg_curves_q05_b0, psra_{prov}.psra_{prov}_agg_curves_q05_r1, psra_{prov}.psra_{prov}_agg_curves_q05 CASCADE;

-- create table
CREATE TABLE psra_{prov}.psra_{prov}_agg_curves_q05_b0(
return_period varchar,
loss_type varchar,
fsauid varchar,
"GenOcc" varchar,
"GenType" varchar,
loss_value float,
loss_ratio float,
annual_frequency_of_exceedence float
);

-- create table
CREATE TABLE psra_{prov}.psra_{prov}_agg_curves_q05_r1(
return_period varchar,
loss_type varchar,
fsauid varchar,
"GenOcc" varchar,
"GenType" varchar,
loss_value float,
loss_ratio float,
annual_frequency_of_exceedence float
);



-- script to agg curves - q95
DROP TABLE IF EXISTS psra_{prov}.psra_{prov}_agg_curves_q95_b0, psra_{prov}.psra_{prov}_agg_curves_q95_r1, psra_{prov}.psra_{prov}_agg_curves_q95 CASCADE;

-- create table
CREATE TABLE psra_{prov}.psra_{prov}_agg_curves_q95_b0(
return_period varchar,
loss_type varchar,
fsauid varchar,
"GenOcc" varchar,
"GenType" varchar,
loss_value float,
loss_ratio float,
annual_frequency_of_exceedence float
);

-- create table
CREATE TABLE psra_{prov}.psra_{prov}_agg_curves_q95_r1(
return_period varchar,
loss_type varchar,
fsauid varchar,
"GenOcc" varchar,
"GenType" varchar,
loss_value float,
loss_ratio float,
annual_frequency_of_exceedence float
);


-- script to agg curves stats
DROP TABLE IF EXISTS psra_{prov}.psra_{prov}_agg_curves_stats_b0, psra_{prov}.psra_{prov}_agg_curves_stats_r1, psra_{prov}.psra_{prov}_agg_curves_stats CASCADE;

-- create table
CREATE TABLE psra_{prov}.psra_{prov}_agg_curves_stats_b0(
return_period varchar,
loss_type varchar,
fsauid varchar,
"GenOcc" varchar,
"GenType" varchar,
loss_value float,
loss_ratio float,
annual_frequency_of_exceedence float,
region varchar
);

-- create table
CREATE TABLE psra_{prov}.psra_{prov}_agg_curves_stats_r1(
return_period varchar,
loss_type varchar,
fsauid varchar,
"GenOcc" varchar,
"GenType" varchar,
loss_value float,
loss_ratio float,
annual_frequency_of_exceedence float,
region varchar
);



-- script to agg losses -q05
DROP TABLE IF EXISTS psra_{prov}.psra_{prov}_agg_losses_q05_b0, psra_{prov}.psra_{prov}_agg_losses_q05_r1, psra_{prov}.psra_{prov}_agg_losses_q05 CASCADE;

-- create table
CREATE TABLE psra_{prov}.psra_{prov}_agg_losses_q05_b0(
loss_type varchar,
fsauid varchar,
"GenOcc" varchar,
"GenType" varchar,
loss_value float,
exposed_value float,
loss_ratio float
);

-- create table
CREATE TABLE psra_{prov}.psra_{prov}_agg_losses_q05_r1(
loss_type varchar,
fsauid varchar,
"GenOcc" varchar,
"GenType" varchar,
loss_value float,
exposed_value float,
loss_ratio float
);



-- add agg_losses tables - q95
DROP TABLE IF EXISTS psra_{prov}.psra_{prov}_agg_losses_q95_b0, psra_{prov}.psra_{prov}_agg_losses_q95_r1, psra_{prov}.psra_{prov}_agg_losses_q95 CASCADE;

-- create table
CREATE TABLE psra_{prov}.psra_{prov}_agg_losses_q95_b0(
loss_type varchar,
fsauid varchar,
"GenOcc" varchar,
"GenType" varchar,
loss_value float,
exposed_value float,
loss_ratio float
);

-- create table
CREATE TABLE psra_{prov}.psra_{prov}_agg_losses_q95_r1(
loss_type varchar,
fsauid varchar,
"GenOcc" varchar,
"GenType" varchar,
loss_value float,
exposed_value float,
loss_ratio float
);


-- script to agg losses stats
DROP TABLE IF EXISTS psra_{prov}.psra_{prov}_agg_losses_stats_b0, psra_{prov}.psra_{prov}_agg_losses_stats_r1, psra_{prov}.psra_{prov}_agg_losses_stats CASCADE;

-- create table
CREATE TABLE psra_{prov}.psra_{prov}_agg_losses_stats_b0(
loss_type varchar,
fsauid varchar,
"GenOcc" varchar,
"GenType" varchar,
loss_value float,
exposed_value float,
loss_ratio float,
region varchar
);

CREATE TABLE psra_{prov}.psra_{prov}_agg_losses_stats_r1(
loss_type varchar,
fsauid varchar,
"GenOcc" varchar,
"GenType" varchar,
loss_value float,
exposed_value float,
loss_ratio float,
region varchar
);


/* psra_3.Create_table_avg_losses_stats.sql */
-- script to agg losses stats
DROP TABLE IF EXISTS psra_{prov}.psra_{prov}_avg_losses_stats_b0, psra_{prov}.psra_{prov}_avg_losses_stats_r1, psra_{prov}.psra_{prov}_avg_losses_stats CASCADE;

-- create table
CREATE TABLE psra_{prov}.psra_{prov}_avg_losses_stats_b0(
PRIMARY KEY(asset_id),
asset_id varchar,
"BldEpoch" varchar,
"BldgType" varchar,
"EqDesLev" varchar,
"GenOcc" varchar,
"GenType" varchar,
"LandUse" varchar,
"OccClass" varchar,
"SAC" varchar,
"SSC_Zone" varchar,
"SauidID" varchar,
adauid varchar,
cdname varchar,
cduid varchar,
csdname varchar,
csduid varchar,
dauid varchar,
ername varchar,
eruid varchar,
fsauid varchar,
prname varchar,
pruid varchar,
sauid varchar,
taxonomy varchar,
lon float,
lat float,
contents float,
nonstructural float,
occupants float,
structural float
);



-- create table
CREATE TABLE psra_{prov}.psra_{prov}_avg_losses_stats_r1(
PRIMARY KEY(asset_id),
asset_id varchar,
"BldEpoch" varchar,
"BldgType" varchar,
"EqDesLev" varchar,
"GenOcc" varchar,
"GenType" varchar,
"LandUse" varchar,
"OccClass" varchar,
"SAC" varchar,
"SSC_Zone" varchar,
"SauidID" varchar,
adauid varchar,
cdname varchar,
cduid varchar,
csdname varchar,
csduid varchar,
dauid varchar,
ername varchar,
eruid varchar,
fsauid varchar,
prname varchar,
pruid varchar,
sauid varchar,
taxonomy varchar,
lon float,
lat float,
contents float,
nonstructural float,
occupants float,
structural float
);




 /* psra_3.Create_table_src_loss_table.sql */
-- script to agg curves stats
DROP TABLE IF EXISTS lut.psra_source_types,psra_{prov}.psra_{prov}_src_loss_b0, psra_{prov}.psra_{prov}_src_loss_r1, psra_{prov}.psra_{prov}_src_loss CASCADE;

-- create source type table
CREATE TABLE lut.psra_source_types(
code varchar,
name varchar,
tectonicregion varchar
);

-- create table
CREATE TABLE psra_{prov}.psra_{prov}_src_loss_b0(
source varchar,
loss_type varchar,
loss_value float,
region varchar
);



-- create table
CREATE TABLE psra_{prov}.psra_{prov}_src_loss_r1(
source varchar,
loss_type varchar,
loss_value float,
region varchar
);